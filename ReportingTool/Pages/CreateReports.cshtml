@page
@model Reportingtool.Pages.CreateReportsModel
@{
    ViewData["Title"] = Model.Current_User + " - Create Reports";
}


<!--Main layout-->
<main>
    <div class="container">


        <hr class="my-5">

        <!--Section: Sched Maint Header-->
        <section class="mt-5 wow fadeIn" style="visibility: visible; animation-name: fadeIn;">



            <!-- Main heading -->
            <h2 class=" mb-3">Create Reports</h2>

            <p>
                Here is the summary of the reports you just submit:::: @Model.GeneratedReportSummary.Count
            </p>

            @for (int i = 0; i< Model.GeneratedReportSummary.Count; ++i)
            {
                <p>@Model.GeneratedReportSummary[i]</p>
            }
            <!-- Main heading -->



        </section>
        <!--Section: Sched Maint Header-->

        <hr class="my-5">

        <!--Grid column-->
        <div class="col-md-12 mb-4">
            <h4 class="text-muted text-center">
                Select a Completed Route
            </h4>
            <!-- <hr>-->
            <!-- List group -->
            <div class="list-group py-3" id="myList" role="tablist">
                @for (int i = 0; i < Model.Completed_Route_Call.Count; ++i)
                {
                    var status_index = i > 0 ? 1 : 0;
                    <a class="list-group-item list-group-item-action d-flex justify-content-between align-items-center @(Model.active_status_list[status_index])" data-toggle="list" href="#completedRoute@(i)" role="tab" aria-selected=@Model.aria_selected_status_list[status_index]>
                        @Model.Completed_Route_Call[i].Route.RouteDescription
                        <span class="badge mdb-color white-text badge-pill">@Model.Machine_List_Dict[Model.Completed_Route_Call[i].PK_CallId].Count</span>
                    </a>
                }
            </div>

        </div>
        <!--Grid column-->
        <!--Section: Maintenance Table-->

        <section>
            <!--Grid row-->

            <div class="row wow fadeIn justify-content-center" style="visibility: visible; animation-name: fadeIn;">

                <form method="post" asp-page-handler="createreport" id="createreport">
                    <!-- Tab panes -->
                    <div class="tab-content col-md-12 py-2" id="machinesOnRoute">
                        @for (int i = 0, machine_count = 0; i < Model.Completed_Route_Call.Count; ++i)
                        {

                            var status_index = i > 0 ? 1 : 0;
                            var current_route = Model.Completed_Route_Call[i];

                            <div class="tab-pane @(Model.active_status_list[status_index])" id="completedRoute@(i)" role="tabpanel">
                                <div class="table-responsive-md">
                                    <table id="dtCompletedRoute@(i)" class="rt-table table table-striped table-bordered" cellspacing="0" width="100%">
                                        <caption class="text-center text-muted border border-bottom-0 border-light py-3 rgba-grey-slight">
                                            @current_route.Route.RouteDescription
                                        </caption>
                                        <thead>
                                            <tr>
                                                <th class="th-sm">Missed | No Action | Anomaly</th>
                                                <th class="th-sm">Machine Name</th>
                                                <th class="th-sm">Condition</th>
                                                <th class="th-sm">Reason</th>
                                                <th class="th-sm">Comments</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (var mtrain in Model.Machine_List_Dict[current_route.PK_CallId])
                                            {
                                                <input type="hidden" name="InputReportList[@machine_count].MachineTrainId" value=@mtrain.PK_MachineTrainId>
                                                <input type="hidden" name="InputReportList[@machine_count].Machine_Train_Long_Name" value="@mtrain.Machine_Train_Long_Name">
                                                <input type="hidden" name="InputReportList[@machine_count].Machine_Train" value="@mtrain.Machine_Train">
                                                <input type="hidden" name="InputReportList[@machine_count].PK_CallId" value=@current_route.PK_CallId>
                                                <input type="hidden" name="InputReportList[@machine_count].RouteDescription" value="@current_route.Route.RouteDescription">
                                                <tr>
                                                    <td>
                                                        <div class="btn-group btn-group-lg" data-toggle="buttons">

                                                            <label class="rt-radio rt-radio-unique btn btn-sm form-check-label waves-effect waves-light">
                                                                <input class="form-check-input" type="radio" name="InputReportList[@machine_count].MainOption" id="mt548-missed" value="missed"> <i class="fas fa-times-circle"></i>
                                                            </label>
                                                            <label class="rt-radio rt-radio-default btn btn-sm form-check-label waves-effect waves-light">
                                                                <input class="form-check-input" type="radio" name="InputReportList[@machine_count].MainOption" id="mt548-good" value="good"> <i class="fas fa-check-circle"></i>
                                                            </label>
                                                            <label class="rt-radio rt-radio-amber btn btn-sm form-check-label waves-effect waves-light">
                                                                <input class="form-check-input" type="radio" name="InputReportList[@machine_count].MainOption" id="mt548-anomaly" value="anomaly"> <i class="fas fa-exclamation-triangle"></i>
                                                            </label>
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <strong>@mtrain.Machine_Train</strong> <br> @mtrain.Machine_Train_Long_Name
                                                    </td>
                                                    <td>
                                                        @mtrain.Condition<br>
                                                        <small>	@mtrain.Change_In_Condition	</small>
                                                    </td>
                                                    <td>
                                                        <select class="custom-select custom-select-sm missed_reason" name="InputReportList[@machine_count].Reason" id="missed_reason">
                                                            <option value=0 selected="">Select a Reason</option>
                                                            <option value=1>@Model.reason_list[1]</option>
                                                            <option value=2>@Model.reason_list[2]</option>
                                                            <option value=3>@Model.reason_list[3]</option>
                                                        </select>
                                                    </td>
                                                    <td><input class="form-control form-control-sm" name="InputReportList[@machine_count].Comments" type="text" placeholder="Additional Comments"></td>
                                                </tr>

                                                machine_count += 1;
                                            }
                                        </tbody>
                                        <tfoot>
                                            <tr>
                                                <th class="th-sm">Missed | No Action | Anomaly</th>
                                                <th class="th-sm">Machine Name</th>
                                                <th class="th-sm">Condition</th>
                                                <th class="th-sm">Reason</th>
                                                <th class="th-sm">Comments</th>
                                            </tr>
                                        </tfoot>
                                    </table>

                                </div>
                            </div>
                        }
                    </div>
                </form>
                <!-- Tab panes -->
                <div class="py-3 col-md-12 ">
                    <button type="submit" class="btn btn-outline-primary waves-effect btn-block btnCreateReportSubmit">Submit</button>
                </div>
            </div>
            <!-- Tab panes -->
        </section>
        <!--Section: Missed Machines -->
        <hr class="my-5">
    </div>
</main>